---
import PlotFigure from "../components/PlotFigure.astro";
import Layout from "../layouts/Layout.astro";
import * as Plot from "@observablehq/plot";
import penguins from "../assets/penguins.json";

const penguinsAdelie = penguins.filter(p => p.species === "Adelie");
const penguinsGentoo = penguins.filter(p => p.species === "Gentoo");
const penguinsChinstrap = penguins.filter(p => p.species === "Chinstrap");

const tabs = ["Adelie", "Gentoo", "Chinstrap"];
---

<Layout>
  <main class="max-w-5xl mx-auto px-4 py-8">
    <div class="bg-blue-600 text-white p-6 mb-8 rounded">
      <h1 class="text-2xl font-bold text-center mb-2">Toutes les espèces avec Tabs</h1>
      <p class="text-center text-blue-100">Navigation rapide entre les espèces</p>
    </div>

    <!-- Onglets -->
    <div class="flex justify-center gap-4 mb-4">
      {tabs.map((tab, index) => (
        <button class="tab-btn border-b-2 border-transparent px-4 py-2 font-semibold" data-index={index}>
          {tab}
        </button>
      ))}
    </div>

    <!-- Contenus -->
    <div>
      <div class="tab-content">
        <PlotFigure
          options={{
            marks: [Plot.dot(penguinsAdelie, { x: "culmen_length_mm", y: "culmen_depth_mm", stroke: "species", fill: "species", fillOpacity: 0.7, r: 3 })],
            marginLeft: 50,
            marginBottom: 50,
            grid: true
          }}
        />
      </div>
      <div class="tab-content hidden">
        <PlotFigure
          options={{
            marks: [Plot.dot(penguinsGentoo, { x: "culmen_length_mm", y: "culmen_depth_mm", stroke: "species", fill: "species", fillOpacity: 0.7, r: 3 })],
            marginLeft: 50,
            marginBottom: 50,
            grid: true
          }}
        />
      </div>
      <div class="tab-content hidden">
        <PlotFigure
          options={{
            marks: [Plot.dot(penguinsChinstrap, { x: "culmen_length_mm", y: "culmen_depth_mm", stroke: "species", fill: "species", fillOpacity: 0.7, r: 3 })],
            marginLeft: 50,
            marginBottom: 50,
            grid: true
          }}
        />
      </div>
    </div>

    <script>
      const tabsButtons = document.querySelectorAll(".tab-btn");
      const tabsContents = document.querySelectorAll(".tab-content");

      tabsButtons.forEach((btn, index) => {
        btn.addEventListener("click", () => {
          tabsContents.forEach(content => content.classList.add("hidden"));
          tabsContents[index].classList.remove("hidden");

          tabsButtons.forEach(b => b.classList.remove("border-blue-600", "font-bold"));
          btn.classList.add("border-blue-600", "font-bold");
        });
      });

      // Afficher le premier onglet par défaut
      tabsButtons[0].classList.add("border-blue-600", "font-bold");
    </script>
  </main>
</Layout>
